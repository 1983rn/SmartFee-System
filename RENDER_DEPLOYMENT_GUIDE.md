# SmartFee Revenue - Render Deployment Guide

This guide provides step-by-step instructions for deploying the SmartFee Revenue application on Render.

## Prerequisites

1. **Git Repository**: Your code should be in a Git repository (GitHub, GitLab, or Bitbucket)
2. **Render Account**: Create a free account at [render.com](https://render.com)

## Fixed Issues

✅ **Python Version Compatibility**: Updated to Python 3.11.9  
✅ **Virtual Environment Error**: Fixed ensurepip error with proper build commands  
✅ **Database Configuration**: Set up PostgreSQL with proper connection handling  
✅ **Environment Variables**: Configured production-ready settings  
✅ **Dependencies**: Updated to compatible versions for Render  

## Deployment Steps

### 1. Connect Your Repository

1. Log in to your Render dashboard
2. Click "New +" and select "Blueprint"
3. Connect your Git repository containing the SmartFee Revenue code
4. Render will automatically detect the `render.yaml` file

### 2. Environment Variables (Already Configured)

The following environment variables are automatically configured in `render.yaml`:

- `FLASK_APP=wsgi.py`
- `FLASK_ENV=production`
- `SECRET_KEY` (auto-generated by Render)
- `DATABASE_URL` (from PostgreSQL service)
- `PYTHONUNBUFFERED=true`
- `DEFAULT_USERNAME=CWED` (default admin username)
- `DEFAULT_PASSWORD=RNTECH` (default admin password)
- `DEV_USERNAME=CWED` (developer username)
- `DEV_PASSWORD=RNTECH` (developer password)

### 3. Database Setup

The blueprint includes:
- **PostgreSQL Database**: Free tier database named `smartfee-db`
- **Automatic Connection**: Environment variable `DATABASE_URL` is automatically configured
- **Schema Initialization**: Database tables are created during build process

### 4. Deploy

1. Review the blueprint configuration
2. Click "Apply" to start deployment
3. Render will:
   - Create the PostgreSQL database
   - Build the web service with Python 3.11.9
   - Install dependencies from `requirements.txt`
   - Initialize the database with `build.py`
   - Start the application with Gunicorn

## Post-Deployment

### 1. Access Your Application

- Your app will be available at: `https://your-service-name.onrender.com`
- You can find the exact URL in your Render dashboard

### 2. First Login

**Developer Access:**
- Username: `CWED`
- Password: `RNTECH`
- Role: Developer (can manage schools and create school admins)

### 3. Create School Administrators

1. Log in as developer
2. Go to "Manage Schools"
3. Create school configurations and admin users
4. School admins will need to change their passwords on first login

## Configuration Files Summary

### `render.yaml` (Blueprint Configuration)
- Defines web service and PostgreSQL database
- Sets environment variables
- Configures build and start commands

### `runtime.txt`
- Specifies Python 3.11.9

### `requirements.txt`
- Lists all Python dependencies with compatible versions

### `build.py`
- Initializes database on deployment
- Creates tables and default admin user

### `wsgi.py`
- WSGI entry point for Gunicorn

## Troubleshooting

### Common Issues and Solutions

1. **Build Fails**: Check the build logs in Render dashboard
2. **Database Connection Error**: Verify DATABASE_URL is set correctly
3. **Import Errors**: Ensure all dependencies are in requirements.txt
4. **Static Files**: Make sure static files are in the correct directory

### Support

If you encounter issues:
1. Check Render build and deploy logs
2. Verify all configuration files are correct
3. Contact support if database connection issues persist

## Security Notes

⚠️ **Important**: After deployment, consider:
1. Changing default admin credentials
2. Setting up proper SSL/TLS (handled by Render)
3. Configuring backup strategies for your database
4. Setting up monitoring and logging

## Features Available

- ✅ Multi-tenant architecture (multiple schools)
- ✅ Student fee management (PTA, SDF, Boarding)
- ✅ Income and expenditure tracking
- ✅ Professional receipt generation
- ✅ Budget management
- ✅ User management and authentication
- ✅ Data encryption for sensitive information
- ✅ PostgreSQL database with automatic backups

Your SmartFee Revenue application is now ready for production use on Render!